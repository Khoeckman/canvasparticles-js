class ByteArrayConverter{static encodeByteArrayToString(e,t){if(!(Array.isArray(e)||e instanceof Uint8Array))throw new TypeError("encodedString is neither an Array nor Uint8Array");if(!Number.isInteger(t))throw new TypeError("radix is not an integer");if((t<2||t>36)&&64!==t)throw new RangeError("radix is not between 2 and 36 or 64");if(e instanceof Uint8Array||(e=new Uint8Array(e)),64===t){if("undefined"==typeof btoa)return Buffer.from(e).toString("base64");let t="";const r=32768;for(let n=0;n<e.length;n+=r)t+=String.fromCharCode(...e.subarray(n,n+r));return btoa(t)}const r=Math.ceil(Math.log(256)/Math.log(t));return Array.from(e).map((e=>e.toString(t).padStart(r,"0"))).join("")}static decodeStringToByteArray(e,t){if("string"!=typeof e)throw new TypeError("encodedString is not a string");if(!Number.isInteger(t))throw new TypeError("radix is not an integer");if((t<2||t>36)&&64!==t)throw new RangeError("radix is not between 2 and 36 or 64");if(64===t)return"undefined"==typeof atob?Uint8Array.from(Buffer.from(e,"base64")):Uint8Array.from(atob(e),(e=>e.charCodeAt(0)));const r=Math.ceil(Math.log(256)/Math.log(t)),n=Math.ceil(e.length/r),a=new Uint8Array(n),o=n*r;let i=0;for(let n=0;n<o;n+=r)a[i++]=parseInt(e.slice(n,n+r),t)||0;return a}}
class TRA{static encrypt(e,t=64){let r=(new TextEncoder).encode(e);return r=this.#e(r,1),ByteArrayConverter.encodeByteArrayToString(r,t)}static decrypt(e,t=64){let r=ByteArrayConverter.decodeStringToByteArray(e,t);return r=this.#e(r,-1),(new TextDecoder).decode(r)}static#e(e,t){if(!t)return e;const r=e.length,n=new Uint32Array(256);for(let e=0;e<256;e++){let t=e^73240379*r;t=Math.imul(t^t>>>16,668269357),t=Math.imul(t^t>>>15,391538609),t^=t>>>16,n[e]=t}const a=new Uint8Array(r);for(let o=0;o<r;o++){let i=o+2654431673*r+n[255&o]|0;i^=i>>>16,i=Math.imul(i,2246818411),i^=i>>>13,i=Math.imul(i,3283267125),i^=i>>>16,a[o]=e[o]+(255&i)*t&255}return a}}
class StorageManager{static version="4.1.5";static TRA=TRA;itemName;defaultValue;encodeFn;decodeFn;storage;#t;constructor(e,t={}){const{defaultValue:r,encodeFn:n=(e=>StorageManager.TRA.encrypt(e,64)),decodeFn:a=(e=>StorageManager.TRA.decrypt(e,64)),storage:o=window.localStorage}=t;if("string"!=typeof e)throw new TypeError("itemName is not a string");if(this.itemName=e,this.defaultValue=r,n&&"function"!=typeof n)throw new TypeError("encodeFn is defined but is not a function");if(this.encodeFn=n||(e=>e),a&&"function"!=typeof a)throw new TypeError("decodeFn is defined but is not a function");if(this.decodeFn=a||(e=>e),!(o instanceof Storage))throw new TypeError("storage must be an instance of Storage");this.storage=o,this.sync()}set value(e){this.#t=e;const t="string"==typeof e?e:"\0JSON\0 "+JSON.stringify(e);this.storage.setItem(this.itemName,this.encodeFn(t))}get value(){return this.#t??this.defaultValue}sync(e=this.decodeFn){let t=this.storage.getItem(this.itemName);if("string"!=typeof t)return this.reset();try{t=e(t)}catch(e){return console.error(e),this.reset()}return t.startsWith("\0JSON\0 ")?(t=t.slice(7),this.value="undefined"===t?void 0:JSON.parse(t)):this.value=t}reset(){return this.value=this.defaultValue}remove(){this.#t=void 0,this.storage.removeItem(this.itemName)}clear(){this.#t=void 0,this.storage.clear()}isDefault(){return this.#t===this.defaultValue}}export{StorageManager as default};